---
title: "Model Training"
author: "Aleksander Dietrichson, PhD"
#monobackgroundcolor: "lightgrey"
format: html
---
```{r}
#| include: false
library(xmas3)
library(ReinforcementLearning)
library(dplyr)
.nf <- function(x){format(x,big.mark=",")}
```


Based on prior notes and analysis it seems reasonable to assume that we should be able to train an RL model on several grid sizes. We will start with the smallest sizes and work our way up, considering the actual magnitute of the combinations, which rise rapidly:

* For 3x3 |S| = $2^{3\times3}$ =`r 2^(3*3) |> .nf()`
* For 3x4 |S| = $2^{3\times4}$ =`r 2^(3*4) |> .nf()`
* For 3x5 |S| = $2^{3\times5}$ =`r 2^(3*5) |> .nf()`
* For 4x4 |S| = $2^{4\times4}$ =`r 2^(4*4) |> .nf()`
* For 3x6 |S| = $2^{3\times5}$ =`r 2^(3*6) |> .nf()`
* For 4x5 |S| = $2^{4\times5}$ =`r 2^(4*5) |> .nf()`
* For 4x6 |S| = $2^{4\times5}$ =`r 2^(4*6) |> .nf()`
* For 5x5 |S| = $2^{5\times5}$ =`r 2^(5*5) |> .nf()`

It seems unlikely that we will be able to train models beyong the 3x6 space with our current infrastructure. It also seems that the algebraic notation, which is more human readable, and thus more convenient for the researcher (i.e. me), will add minimal overhead in the parsing and scoring processes.

## Functions Needed

For the purposes of setting up the agent training for a 4x5 board, we implemented the following functions in the {xmas3} package.

### Create_state_space

```{r}
xmas3::create_state_space
```

This function returns a list of integers with the appropriate class (mostly for printing and debugging.)

### create_action_space

This function generates an action space in chess notation given a grid on ncol and nrows.

```{r}
#| echo: false
xmas3::create_action_space
```

### make_move

This function takes as input a board B and a *move* (in chess notation). It makes the move and returns the resulting board.

```{r}
#| echo: false

xmas3::make_move
```

### score_binary_board

This function takes as input a binary matrix and calculates the resulting score according to the rules of X-mas-3.

```{r}
#| echo: false
xmas3::score_binary_board
```

These functions will allow us to create the input needed to train a *Reinforcement Learning* (RL) model.

{{< include model-the-3-by-3-board.qmd >}}
